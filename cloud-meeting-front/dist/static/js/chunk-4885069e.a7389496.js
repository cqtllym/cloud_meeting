(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4885069e"],{f4f8:function(t,e,r){t.exports=r.p+"static/img/meeting.b6c916b6.png"},f8ae:function(t,e,r){"use strict";r.d(e,"e",(function(){return u})),r.d(e,"c",(function(){return m})),r.d(e,"h",(function(){return l})),r.d(e,"a",(function(){return d})),r.d(e,"d",(function(){return g})),r.d(e,"b",(function(){return w})),r.d(e,"f",(function(){return v})),r.d(e,"g",(function(){return T}));var n=r("c964"),a=(r("96cf"),r("b775")),i=r("7424"),o=r("4328"),s=r.n(o);function u(t){return c.apply(this,arguments)}function c(){return c=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(a["e"])(i["ROOM_RESERVATION"],a["a"].PUT,s.a.stringify(e),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}));case 1:case"end":return t.stop()}}),t)}))),c.apply(this,arguments)}function m(t){return p.apply(this,arguments)}function p(){return p=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(a["e"])(i["ROOM_RESERVATION"],a["a"].POST,s.a.stringify(e),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}));case 1:case"end":return t.stop()}}),t)}))),p.apply(this,arguments)}function l(t){return f.apply(this,arguments)}function f(){return f=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(a["e"])(i["ROOM_RESERVATION"],a["a"].GET,e));case 1:case"end":return t.stop()}}),t)}))),f.apply(this,arguments)}function d(t){return h.apply(this,arguments)}function h(){return h=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(a["e"])(i["AVALIABLE_ROOM"],a["a"].GET,e));case 1:case"end":return t.stop()}}),t)}))),h.apply(this,arguments)}function g(t){return b.apply(this,arguments)}function b(){return b=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(a["e"])(i["COMMON_RESERVATION"],a["a"].PUT,s.a.stringify(e),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}));case 1:case"end":return t.stop()}}),t)}))),b.apply(this,arguments)}function w(t){return y.apply(this,arguments)}function y(){return y=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(a["e"])(i["COMMON_RESERVATION"],a["a"].POST,s.a.stringify(e),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}));case 1:case"end":return t.stop()}}),t)}))),y.apply(this,arguments)}function v(t){return O.apply(this,arguments)}function O(){return O=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(a["e"])(i["COMMON_RESERVATION"],a["a"].GET,e));case 1:case"end":return t.stop()}}),t)}))),O.apply(this,arguments)}function T(t){return R.apply(this,arguments)}function R(){return R=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(a["e"])(i["SEARCH_EMPLOYEE"],a["a"].GET,e));case 1:case"end":return t.stop()}}),t)}))),R.apply(this,arguments)}},fc56:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("a-card",{attrs:{"body-style":{padding:"24px 32px",paddingBottom:"64px",textAlign:"center"},bordered:!1}},[n("img",{staticStyle:{width:"40%","min-width":"150px"},attrs:{src:r("f4f8")}}),n("a-form-model",{ref:"form",attrs:{model:t.form,"label-col":{span:8},"wrapper-col":{span:10},selfUpdate:!0,rules:t.rules}},[n("a-form-model-item",{attrs:{label:"会议主题",prop:"topic"}},[n("a-input",{attrs:{placeholder:"默认为"+t.username+"预约的会议"},model:{value:t.form.topic,callback:function(e){t.$set(t.form,"topic",e)},expression:"form.topic"}},[n("a-icon",{staticStyle:{color:"#c7c7c7"},attrs:{slot:"suffix",type:"file"},slot:"suffix"})],1)],1),n("a-form-model-item",{attrs:{label:"开始时间",prop:"startTime"}},[n("a-date-picker",{staticStyle:{width:"100%"},attrs:{"show-time":"",type:"date",placeholder:"请选择开始时间","disabled-date":t.disabledDate},model:{value:t.form.startTime,callback:function(e){t.$set(t.form,"startTime",e)},expression:"form.startTime"}})],1),n("a-form-model-item",{attrs:{label:"会议时长",prop:"duration"}},[n("a-time-picker",{staticStyle:{width:"100%"},attrs:{format:"HH:mm",placeholder:"请选择会议时长"},model:{value:t.form.duration,callback:function(e){t.$set(t.form,"duration",e)},expression:"form.duration"}})],1),n("a-form-model-item",{attrs:{label:"会议室",prop:"roomId"}},[n("a-select",{attrs:{placeholder:"请选择会议室"},model:{value:t.form.roomId,callback:function(e){t.$set(t.form,"roomId",e)},expression:"form.roomId"}},t._l(t.roomList,(function(e,r){return n("a-select-option",{key:r,attrs:{value:e.id}},[t._v(t._s(e.name))])})),1)],1),n("a-form-model-item",{attrs:{label:"会议密码",prop:"password"}},[n("a-input",{attrs:{placeholder:"默认无会议密码"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}},[n("a-icon",{staticStyle:{color:"#c7c7c7"},attrs:{slot:"suffix",type:"eye"},slot:"suffix"})],1)],1),n("a-form-model-item",{attrs:{label:"与会人"}},[n("a-select",{staticStyle:{width:"100%"},attrs:{mode:"multiple","label-in-value":"",value:t.participants,placeholder:"根据用户名搜索与会人","filter-option":!1,"not-found-content":t.fetching?void 0:null},on:{search:t.fetchUser,change:t.handleChange}},[t.fetching?n("a-spin",{attrs:{slot:"notFoundContent",size:"small"},slot:"notFoundContent"}):t._e(),t._l(t.employeeList,(function(e){return n("a-select-option",{key:e.userId},[t._v(" "+t._s(e.username)+" ")])})),0!=t.attendeeList.length?n("a-select-opt-group",{key:"2"},[n("span",{attrs:{slot:"label"},slot:"label"},[n("a-icon",{attrs:{type:"user"}}),t._v("常用与会人")],1),t._l(t.attendeeList,(function(e){return n("a-select-option",{key:e.userId+"-2"},[t._v(" "+t._s(e.username)+" ")])}))],2):t._e()],2)],1)],1),n("a-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("预约会议")]),n("a-button",{on:{click:t.resetForm}},[t._v("重置信息")]),n("a-modal",{attrs:{visible:t.visible,footer:null},on:{cancel:function(e){t.visible=!t.visible}}},[n("a-result",{attrs:{status:"success",title:"您已成功预约会议 "+t.meetingNumber+" ！","sub-title":t.successMsg},scopedSlots:t._u([{key:"extra",fn:function(){return[n("a-button",{key:"check",attrs:{type:"link",size:"large"},on:{click:function(e){return t.goTo("/meetingManagement/my")}}},[t._v(" 前往我的会议查看 ")])]},proxy:!0}])})],1)],1)},a=[],i=r("f3f3"),o=(r("4d63"),r("ac1f"),r("25f0"),r("b047")),s=r.n(o),u=r("c1df"),c=r.n(u),m=r("5880"),p=r("f8ae"),l={data:function(){return this.lastFetchId=0,this.fetchUser=s()(this.fetchUser,800),{form:{topic:"",startTime:"",duration:"",roomId:void 0,text:"",requirePwd:!1,password:""},rules:{topic:[{max:20,message:"会议主题不要超过20字",trigger:"change"}],startTime:[{required:!0,message:"请选择开始时间",trigger:"change"}],duration:[{required:!0,message:"请选择会议时长",trigger:"change"}],roomId:[{required:!0,message:"请选择会议室",trigger:"change"}],password:[{pattern:new RegExp(/^[1-9]\d*$/,"g"),message:"会议密码必须为数字",trigger:"change"},{max:8,message:"会议密码必须为8位以内",trigger:"change"}]},participants:[],participantsIdList:[],roomList:[],fetching:!1,employeeList:[],attendeeList:[{userId:111,username:"ooo"}],visible:!1,meetingId:"",meetingNumber:""}},created:function(){this.form.duration=c()(new Date(2013,0,0,0,30,0,0).getTime())},mounted:function(){},watch:{"form.startTime":{handler:function(t){this.form.duration&&this.getRoomList(t,this.form.duration)}},"form.duration":{handler:function(t){this.form.startTime&&this.getRoomList(this.form.startTime,t)}},"form.password":{handler:function(t){this.form.requirePwd=!!t}}},computed:Object(i["a"])(Object(i["a"])({},Object(m["mapGetters"])("account",["username","userId","companyId"])),{},{successMsg:function(){return this.form.startTime&&this.form.duration?"会议室为"+this.form.roomId+" ,会议开始时间为："+this.form.startTime.toDate().toLocaleString()+" , 预计持续"+this.form.duration.toDate().getHours()+"时"+this.form.duration.toDate().getMinutes()+"分"+(this.form.requirePwd?",\n会议密码为"+this.form.password:"。"):""}}),methods:{moment:c.a,getRoomList:function(t,e){var r=this;Date.prototype.clone=function(){return new Date(this.valueOf())};var n=t.toDate().clone();n.setHours(t.toDate().getHours()+e.toDate().getHours()),n.setMinutes(t.toDate().getMinutes()+e.toDate().getMinutes());var a={startTime:t.toDate().getTime(),endTime:n.getTime(),companyId:this.companyId};Object(p["a"])(a).then((function(t){r.roomList=t.data.data}))},disabledDate:function(t){var e=new Date;return e.setMinutes(e.getMinutes()+30),!(!t||!e)&&e.valueOf()>=t.valueOf()},fetchUser:function(t){var e=this;this.fetching=!0,this.employeeList=[];var r={userName:t,companyId:this.companyId};Object(p["g"])(r).then((function(t){e.employeeList=t.data.data,e.fetching=!1}))},handleChange:function(t){this.participantsIdList=[];for(var e=0;e<t.length;e++)this.participantsIdList.push(t[e].key);Object.assign(this,{participants:t,employeeList:[],fetching:!1})},handleSubmit:function(){var t=this;this.$refs.form.validate((function(e){if(!e)return!1;t.handleRoomReservation()}))},handleRoomReservation:function(){var t=this;Date.prototype.clone=function(){return new Date(this.valueOf())};var e=this.form.startTime.toDate(),r=e.clone(),n=this.form.duration.toDate();r.setHours(e.getHours()+n.getHours()),r.setMinutes(e.getMinutes()+n.getMinutes());var a={topic:this.form.topic,scheduledStartTime:e.getTime(),scheduledEndTime:r.getTime(),roomId:this.form.roomId,hostId:this.userId,participants:this.participantsIdList,requiredPassword:this.form.requirePwd,password:this.form.password};Object(p["e"])(a).then((function(e){t.meetingId=e.data.data.meetingId,t.meetingNumber=e.data.data.meetingNumber,t.visible=!0}))},resetForm:function(){this.form.topic="",this.form.startTime="",this.form.duration=c()(new Date(2013,0,0,0,30,0,0).getTime()),this.form.room=void 0,this.form.text="",this.form.requirePwd=!1,this.form.password="",this.participants=[],this.data=[],this.meetingNumber="",this.meetingId="",this.fetching=!1},goTo:function(t){this.$closePage(this.$route),this.$router.push(t),this.visible=!1}}},f=l,d=r("2877"),h=Object(d["a"])(f,n,a,!1,null,"5a1a45f0",null);e["default"]=h.exports}}]);