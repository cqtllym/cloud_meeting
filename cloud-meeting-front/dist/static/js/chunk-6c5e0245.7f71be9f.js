(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6c5e0245"],{5615:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("a-card",{attrs:{"body-style":{padding:"24px 32px",paddingBottom:"64px",textAlign:"center"},bordered:!1}},[n("img",{staticStyle:{width:"40%","min-width":"150px"},attrs:{src:r("f4f8")}}),n("a-form-model",{ref:"form",attrs:{model:t.form,"label-col":{span:8},"wrapper-col":{span:10},selfUpdate:!0,rules:t.rules}},[n("a-form-model-item",{attrs:{label:"会议号",prop:"topic"}},[n("a-input",{attrs:{disabled:!0},model:{value:t.meetingNumber,callback:function(e){t.meetingNumber=e},expression:"meetingNumber"}})],1),n("a-form-model-item",{attrs:{label:"会议主题",prop:"topic"}},[n("a-input",{attrs:{placeholder:"默认为"+t.username+"预约的会议"},model:{value:t.form.topic,callback:function(e){t.$set(t.form,"topic",e)},expression:"form.topic"}},[n("a-icon",{staticStyle:{color:"#c7c7c7"},attrs:{slot:"suffix",type:"file"},slot:"suffix"})],1)],1),n("a-form-model-item",{attrs:{label:"开始时间",prop:"startTime"}},[n("a-date-picker",{staticStyle:{width:"100%"},attrs:{"show-time":"",type:"date",placeholder:"请选择开始时间","disabled-date":t.disabledDate},model:{value:t.form.startTime,callback:function(e){t.$set(t.form,"startTime",e)},expression:"form.startTime"}})],1),n("a-form-model-item",{attrs:{label:"会议时长",prop:"duration"}},[n("a-time-picker",{staticStyle:{width:"100%"},attrs:{format:"HH:mm",placeholder:"请选择会议时长"},model:{value:t.form.duration,callback:function(e){t.$set(t.form,"duration",e)},expression:"form.duration"}})],1),n("a-form-model-item",{attrs:{label:"会议室",prop:"roomId"}},[n("a-select",{attrs:{placeholder:"请选择会议室"},model:{value:t.form.roomId,callback:function(e){t.$set(t.form,"roomId",e)},expression:"form.roomId"}},t._l(t.roomList,(function(e,r){return n("a-select-option",{key:r,attrs:{value:e.id}},[t._v(t._s(e.name))])})),1)],1),n("a-form-model-item",{attrs:{label:"会议密码",prop:"password"}},[n("a-input",{attrs:{placeholder:"默认无会议密码"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}},[n("a-icon",{staticStyle:{color:"#c7c7c7"},attrs:{slot:"suffix",type:"eye"},slot:"suffix"})],1)],1),n("a-form-model-item",{attrs:{label:"与会人"}},[n("a-select",{staticStyle:{width:"100%"},attrs:{mode:"multiple","label-in-value":"",value:t.participants,placeholder:"根据用户名搜索与会人","filter-option":!1,"not-found-content":t.fetching?void 0:null},on:{search:t.fetchUser,change:t.handleChange}},[t.fetching?n("a-spin",{attrs:{slot:"notFoundContent",size:"small"},slot:"notFoundContent"}):t._e(),t._l(t.employeeList,(function(e){return n("a-select-option",{key:e.userId},[t._v(" "+t._s(e.username)+" ")])}))],2)],1)],1),n("a-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("变更会议")]),n("a-button",{on:{click:t.resetForm}},[t._v("重置信息")]),n("a-modal",{attrs:{visible:t.visible,footer:null}},[n("a-result",{attrs:{status:"success",title:"您已成功预约会议 "+t.meetingNumber+" ！","sub-title":t.successMsg},scopedSlots:t._u([{key:"extra",fn:function(){return[n("a-button",{key:"check",attrs:{type:"link",size:"large"},on:{click:function(e){return t.goTo("/meetingManagement/my")}}},[t._v(" 前往我的会议查看 ")])]},proxy:!0}])})],1)],1)},a=[],i=r("f3f3"),o=(r("4d63"),r("ac1f"),r("25f0"),r("b047")),s=r.n(o),u=r("c1df"),c=r.n(u),m=r("5880"),p=r("f8ae"),d={data:function(){return this.lastFetchId=0,this.fetchUser=s()(this.fetchUser,800),{form:{topic:"",startTime:"",duration:"",roomId:void 0,text:"",requirePwd:!1,password:"",hostId:"",host:""},rules:{topic:[{max:20,message:"会议主题不要超过20字",trigger:"change"}],startTime:[{required:!0,message:"请选择开始时间",trigger:"change"}],duration:[{required:!0,message:"请选择会议时长",trigger:"change"}],roomId:[{required:!0,message:"请选择会议室",trigger:"change"}],password:[{pattern:new RegExp(/^[1-9]\d*$/,"g"),message:"会议密码必须为数字",trigger:"change"},{max:8,message:"会议密码必须为8位以内",trigger:"change"}]},participants:[],participantsIdList:[],roomList:[],fetching:!1,employeeList:[],visible:!1,meetingId:"",meetingNumber:""}},created:function(){var t=this;this.meetingId=this.$route.params.meetingId,this.meetingNumber=this.$route.params.meetingNumber,this.meetingNumber&&this.meetingId||this.$closePage(this.$route);var e={meetingId:this.meetingId,meetingNumber:this.meetingNumber,userId:this.userId};Object(p["h"])(e).then((function(e){t.form.topic=e.data.data.topic,t.form.roomId=e.data.data.roomId,t.form.startTime=t.moment(e.data.data.startTime),t.form.duration=t.moment(e.data.data.endTime-e.data.data.startTime),t.form.hostId=e.data.data.hostId,t.form.host=e.data.data.host,t.participants=[],t.participantsIdList=[];for(var r=0;r<e.data.data.participants.length;r++)t.participants.push({key:e.data.data.participants[r].userId,label:e.data.data.participants[r].username}),t.participantsIdList.push(e.data.data.participants[r].userId);t.form.password=e.data.data.password}))},mounted:function(){},watch:{"form.startTime":{handler:function(t){this.form.duration&&this.getRoomList(t,this.form.duration)}},"form.duration":{handler:function(t){this.form.startTime&&this.getRoomList(this.form.startTime,t)}},"form.password":{handler:function(t){this.form.requirePwd=!!t}}},computed:Object(i["a"])(Object(i["a"])({},Object(m["mapGetters"])("account",["username","userId","companyId"])),{},{successMsg:function(){return this.form.startTime&&this.form.duration?"会议室为"+this.form.roomId+" ,会议开始时间为："+this.form.startTime.toDate().toLocaleString()+" , 预计持续"+this.form.duration.toDate().getHours()+"时"+this.form.duration.toDate().getMinutes()+"分"+(this.form.requirePwd?",\n会议密码为"+this.form.password:"。"):""}}),methods:{moment:c.a,getRoomList:function(t,e){var r=this;Date.prototype.clone=function(){return new Date(this.valueOf())};var n=t.toDate().clone();n.setHours(t.toDate().getHours()+e.toDate().getHours()),n.setMinutes(t.toDate().getMinutes()+e.toDate().getMinutes());var a={startTime:t.toDate().getTime(),endTime:n.getTime(),companyId:this.companyId};Object(p["a"])(a).then((function(t){r.roomList=t.data.data}))},disabledDate:function(t){var e=new Date;return e.setMinutes(e.getMinutes()+30),!(!t||!e)&&e.valueOf()>=t.valueOf()},fetchUser:function(t){var e=this;this.employeeList=[],this.fetching=!0;var r={userName:t,companyId:this.companyId};Object(p["g"])(r).then((function(t){e.employeeList=t.data.data,e.fetching=!1}))},handleChange:function(t){this.participantsIdList=[];for(var e=0;e<t.length;e++)this.participantsIdList.push(t[e].key);Object.assign(this,{participants:t,employeeList:[],fetching:!1})},handleSubmit:function(){var t=this;this.$refs.form.validate((function(e){if(!e)return!1;Date.prototype.clone=function(){return new Date(this.valueOf())};var r=t.form.startTime.toDate(),n=r.clone(),a=t.form.duration.toDate();n.setHours(r.getHours()+a.getHours()),n.setMinutes(r.getMinutes()+a.getMinutes());var i={meetingNumber:t.meetingNumber,meetingId:t.meetingId,topic:t.form.topic,startTime:r.getTime(),endTime:n.getTime(),roomId:t.form.roomId,hostId:t.userId,host:t.username,participants:t.participantsIdList,requiredPassword:t.form.requirePwd,password:t.form.password};Object(p["c"])(i).then((function(){t.visible=!0}))}))},resetForm:function(){this.form.topic="",this.form.startTime="",this.form.duration=c()(new Date(2013,0,0,0,30,0,0).getTime()),this.form.room=void 0,this.form.text="",this.form.requirePwd=!1,this.form.password="",this.participants=[],this.employeeList=[],this.meetingNumber="",this.meetingId="",this.fetching=!1},goTo:function(t){this.$closePage(this.$route),this.$router.go(t),this.visible=!1},fiveSecondsGo:function(){var t=this,e=5;this.timer||(this.count=e,this.show=!1,this.timer=setInterval((function(){t.count>0&&t.count<=e?t.count--:(t.show=!0,clearInterval(t.timer),t.timer=null,t.visible=!1,t.$closePage(t.$route),t.$router.push("/meetingManagement/my"))}),1e3))}}},l=d,f=r("2877"),h=Object(f["a"])(l,n,a,!1,null,"60c8e183",null);e["default"]=h.exports},f4f8:function(t,e,r){t.exports=r.p+"static/img/meeting.b6c916b6.png"},f8ae:function(t,e,r){"use strict";r.d(e,"e",(function(){return u})),r.d(e,"c",(function(){return m})),r.d(e,"h",(function(){return d})),r.d(e,"a",(function(){return f})),r.d(e,"d",(function(){return g})),r.d(e,"b",(function(){return w})),r.d(e,"f",(function(){return v})),r.d(e,"g",(function(){return O}));var n=r("c964"),a=(r("96cf"),r("b775")),i=r("7424"),o=r("4328"),s=r.n(o);function u(t){return c.apply(this,arguments)}function c(){return c=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(a["e"])(i["ROOM_RESERVATION"],a["a"].PUT,s.a.stringify(e),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}));case 1:case"end":return t.stop()}}),t)}))),c.apply(this,arguments)}function m(t){return p.apply(this,arguments)}function p(){return p=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(a["e"])(i["ROOM_RESERVATION"],a["a"].POST,s.a.stringify(e),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}));case 1:case"end":return t.stop()}}),t)}))),p.apply(this,arguments)}function d(t){return l.apply(this,arguments)}function l(){return l=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(a["e"])(i["ROOM_RESERVATION"],a["a"].GET,e));case 1:case"end":return t.stop()}}),t)}))),l.apply(this,arguments)}function f(t){return h.apply(this,arguments)}function h(){return h=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(a["e"])(i["AVALIABLE_ROOM"],a["a"].GET,e));case 1:case"end":return t.stop()}}),t)}))),h.apply(this,arguments)}function g(t){return b.apply(this,arguments)}function b(){return b=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(a["e"])(i["COMMON_RESERVATION"],a["a"].PUT,s.a.stringify(e),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}));case 1:case"end":return t.stop()}}),t)}))),b.apply(this,arguments)}function w(t){return y.apply(this,arguments)}function y(){return y=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(a["e"])(i["COMMON_RESERVATION"],a["a"].POST,s.a.stringify(e),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}));case 1:case"end":return t.stop()}}),t)}))),y.apply(this,arguments)}function v(t){return I.apply(this,arguments)}function I(){return I=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(a["e"])(i["COMMON_RESERVATION"],a["a"].GET,e));case 1:case"end":return t.stop()}}),t)}))),I.apply(this,arguments)}function O(t){return T.apply(this,arguments)}function T(){return T=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(a["e"])(i["SEARCH_EMPLOYEE"],a["a"].GET,e));case 1:case"end":return t.stop()}}),t)}))),T.apply(this,arguments)}}}]);